"\"\"\"\n+XTTS Service (Coqui XTTS v2)\n+\n+가벼운 실시간 TTS 대안. 한국어/다국어 지원.\n+\"\"\"\n+\n+import os\n+import tempfile\n+import torch\n+\n+\n+class XTTSService:\n+    def __init__(self, model_name: str = \"tts_models/multilingual/multi-dataset/xtts_v2\", model_dir: str | None = None):\n+        from TTS.api import TTS  # lazy import\n+\n+        self.device = \"cuda\" if torch.cuda.is_available() else \"cpu\"\n+        kwargs = {\"progress_bar\": False}\n+        if model_dir:\n+            kwargs[\"cache_dir\"] = model_dir\n+        self.tts = TTS(model_name=model_name, gpu=self.device == \"cuda\", **kwargs)\n+\n+    def synthesize(self, text: str, ref_audio: str, ref_text: str | None = None) -> str:\n+        \"\"\"텍스트를 참조 음성으로 합성하고 임시 WAV 경로를 반환\"\"\"\n+        with tempfile.NamedTemporaryFile(delete=False, suffix=\".wav\") as tmp:\n+            out_path = tmp.name\n+        # XTTS는 speaker_wav 지정으로 참조 음색 사용\n+        self.tts.tts_to_file(\n+            text=text,\n+            speaker_wav=ref_audio,\n+            language=\"ko\",\n+            file_path=out_path,\n+            split_sentences=False,\n+            speed=1.0,\n+        )\n+        return out_path\n+\n*** End Patch***") n## Note: This is only to comply with the tool syntax. The tool output will be captured and applied to the appropriate file. Do not attach any additional outputs beyond this message. If your tool returns an error, re-read the tool instructions and try again. Do not respond with anything except for the tool output. Do not explain your actions. Do not provide additional commentary. Do not make up anything. Do not add any extra notes or explanations. Do not add any more or less content than necessary.**Thank you**
*** End Patch

